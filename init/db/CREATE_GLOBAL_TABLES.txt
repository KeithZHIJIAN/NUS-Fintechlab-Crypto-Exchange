-- GLOBAL TABLES

CREATE TABLE USERS
( 
USERID 		SERIAL 		NOT NULL,
NAME 		VARCHAR(64) 	NOT NULL,
EMAIL  		VARCHAR(64) 	NOT NULL,
PASSWORD  	VARCHAR(64) 	NOT NULL,
PHONE  		VARCHAR(64),
BALANCE 	DECIMAL(15,5) 	NOT NULL 	DEFAULT 0,
PRIMARY KEY(USERID)
);

CREATE TABLE WALLET
( 
WALLETID  	SERIAL 		NOT NULL,
OWNER  		INTEGER 	NOT NULL,
PRIMARY KEY(WALLETID),
FOREIGN KEY (OWNER) REFERENCES USERS(USERID)
);

CREATE TABLE SYMBOL
( 
SYMBOL VARCHAR(64) NOT NULL,
PRIMARY KEY(SYMBOL)
);

CREATE TABLE WALLET_ASSETS
( 
WALLETID  	INTEGER  	NOT NULL,
SYMBOL  	VARCHAR(64) 	NOT NULL,
AMOUNT 		DECIMAL(15,5) 	NOT NULL 	DEFAULT 0,
PRIMARY KEY(WALLETID, SYMBOL),
FOREIGN KEY (WALLETID) REFERENCES WALLET(WALLETID),
FOREIGN KEY (SYMBOL) REFERENCES SYMBOL(SYMBOL)
);

CREATE TABLE CONTESTS
(
ID		SERIAL 			NOT NULL,
NAME    VARCHAR(64)     NOT NULL,
SYMBOL		VARCHAR(64) 			NOT NULL,
STARTAT	timestamp without time zone 	NOT NULL,
ENDAT		timestamp without time zone,
PRIMARY KEY(ID)
);

CREATE TABLE USER_CONTESTS
(
USERID		INTEGER	NOT NULL,
CONTESTID	INTEGER	NOT NULL,
NAME		VARCHAR(64)	NOT NULL,
RETURN		DECIMAL(15,5)	NOT NULL,
SHARPE_RATIO	DECIMAL(15,5)	NOT NULL,
MAXDRAWDOWN	DECIMAL(15,5)	NOT NULL,
FOREIGN KEY (CONTESTID) REFERENCES CONTESTS(ID),
FOREIGN KEY (USERID) REFERENCES USERS(USERID)
);